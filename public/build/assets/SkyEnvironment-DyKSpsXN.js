import{g as st,r as ut,j as T}from"./app-B1aaPueH.js";import{S as ct,a as lt}from"./Stars-CZiyVzkl.js";import"./extends-CF3RwP-h.js";import"./events-776716bd.esm-C3d9VITL.js";import"./constants-De28-u0u.js";var nt={exports:{}};(function(I,U){(function(){var P=Math.PI,e=Math.sin,r=Math.cos,L=Math.tan,q=Math.asin,w=Math.atan2,z=Math.acos,s=P/180,J=1e3*60*60*24,k=2440588,G=2451545;function N(t){return t.valueOf()/J-.5+k}function S(t){return new Date((t+.5-k)*J)}function D(t){return N(t)-G}var A=s*23.4397;function $(t,n){return w(e(t)*r(A)-L(n)*e(A),r(t))}function O(t,n){return q(e(n)*r(A)+r(n)*e(A)*e(t))}function B(t,n,i){return w(e(t),r(t)*e(n)-L(i)*r(n))}function K(t,n,i){return q(e(n)*e(i)+r(n)*r(i)*r(t))}function Q(t,n){return s*(280.16+360.9856235*t)-n}function it(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}function V(t){return s*(357.5291+.98560028*t)}function W(t){var n=s*(1.9148*e(t)+.02*e(2*t)+3e-4*e(3*t)),i=s*102.9372;return t+n+i+P}function X(t){var n=V(t),i=W(n);return{dec:O(i,0),ra:$(i,0)}}var m={};m.getPosition=function(t,n,i){var u=s*-i,a=s*n,c=D(t),o=X(c),l=Q(c,u)-o.ra;return{azimuth:B(l,a,o.dec),altitude:K(l,a,o.dec)}};var R=m.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];m.addTime=function(t,n,i){R.push([t,n,i])};var Y=9e-4;function et(t,n){return Math.round(t-Y-n/(2*P))}function Z(t,n,i){return Y+(t+n)/(2*P)+i}function _(t,n,i){return G+t+.0053*e(n)-.0069*e(2*i)}function at(t,n,i){return z((e(t)-e(n)*e(i))/(r(n)*r(i)))}function rt(t){return-2.076*Math.sqrt(t)/60}function ot(t,n,i,u,a,c,o){var l=at(t,i,u),d=Z(l,n,a);return _(d,c,o)}m.getTimes=function(t,n,i,u){u=u||0;var a=s*-i,c=s*n,o=rt(u),l=D(t),d=et(l,a),h=Z(0,a,d),y=V(h),v=W(y),C=O(v,0),M=_(h,y,v),x,j,p,g,b,E,f={solarNoon:S(M),nadir:S(M-.5)};for(x=0,j=R.length;x<j;x+=1)p=R[x],g=(p[0]+o)*s,b=ot(g,a,c,C,d,y,v),E=M-(b-M),f[p[1]]=S(E),f[p[2]]=S(b);return f};function tt(t){var n=s*(218.316+13.176396*t),i=s*(134.963+13.064993*t),u=s*(93.272+13.22935*t),a=n+s*6.289*e(i),c=s*5.128*e(u),o=385001-20905*r(i);return{ra:$(a,c),dec:O(a,c),dist:o}}m.getMoonPosition=function(t,n,i){var u=s*-i,a=s*n,c=D(t),o=tt(c),l=Q(c,u)-o.ra,d=K(l,a,o.dec),h=w(e(l),L(a)*r(o.dec)-e(o.dec)*r(l));return d=d+it(d),{azimuth:B(l,a,o.dec),altitude:d,distance:o.dist,parallacticAngle:h}},m.getMoonIllumination=function(t){var n=D(t||new Date),i=X(n),u=tt(n),a=149598e3,c=z(e(i.dec)*e(u.dec)+r(i.dec)*r(u.dec)*r(i.ra-u.ra)),o=w(a*e(c),u.dist-a*r(c)),l=w(r(i.dec)*e(i.ra-u.ra),e(i.dec)*r(u.dec)-r(i.dec)*e(u.dec)*r(i.ra-u.ra));return{fraction:(1+r(o))/2,phase:.5+.5*o*(l<0?-1:1)/Math.PI,angle:l}};function H(t,n){return new Date(t.valueOf()+n*J/24)}m.getMoonTimes=function(t,n,i,u){var a=new Date(t);u?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var c=.133*s,o=m.getMoonPosition(a,n,i).altitude-c,l,d,h,y,v,C,M,x,j,p,g,b,E,f=1;f<=24&&(l=m.getMoonPosition(H(a,f),n,i).altitude-c,d=m.getMoonPosition(H(a,f+1),n,i).altitude-c,v=(o+d)/2-l,C=(d-o)/2,M=-C/(2*v),x=(v*M+C)*M+l,j=C*C-4*v*l,p=0,j>=0&&(E=Math.sqrt(j)/(Math.abs(v)*2),g=M-E,b=M+E,Math.abs(g)<=1&&p++,Math.abs(b)<=1&&p++,g<-1&&(g=b)),p===1?o<0?h=f+g:y=f+g:p===2&&(h=f+(x<0?b:g),y=f+(x<0?g:b)),!(h&&y));f+=2)o=d;var F={};return h&&(F.rise=H(a,h)),y&&(F.set=H(a,y)),!h&&!y&&(F[x>0?"alwaysUp":"alwaysDown"]=!0),F},I.exports=m})()})(nt);var dt=nt.exports;const ft=st(dt);function pt({preset:I="noon"}){const U=ut.useMemo(()=>{if(I!=="real-time")return null;const r=new Date,w=ft.getPosition(r,28.45,-16.25),z=w.azimuth,s=w.altitude,J=100,k=J*Math.sin(s),G=J*Math.cos(s),N=G*Math.sin(z),S=G*Math.cos(z),D=s<-.05;return{sunPosition:[N,k,S],turbidity:.1,rayleigh:D?.1:.5,mieCoefficient:.005,mieDirectionalG:.8,stars:D,ambientIntensity:Math.max(.1,Math.sin(Math.max(0,s))*.8)}},[I]),P={sunrise:{sunPosition:[100,10,100],turbidity:.1,rayleigh:.5,mieCoefficient:.005,mieDirectionalG:.8,stars:!1,ambientIntensity:.4},noon:{sunPosition:[50,100,50],turbidity:.1,rayleigh:.1,mieCoefficient:.005,mieDirectionalG:.8,stars:!1,ambientIntensity:.8},sunset:{sunPosition:[-100,10,-100],turbidity:.2,rayleigh:1,mieCoefficient:.005,mieDirectionalG:.8,stars:!1,ambientIntensity:.3},midnight:{sunPosition:[0,-10,0],turbidity:.1,rayleigh:.5,mieCoefficient:.005,mieDirectionalG:.8,stars:!0,ambientIntensity:.2}},e=I==="real-time"?U:P[I]||P.noon;return T.jsxs(T.Fragment,{children:[T.jsx(ct,{sunPosition:e.sunPosition,turbidity:e.turbidity,rayleigh:e.rayleigh,mieCoefficient:e.mieCoefficient,mieDirectionalG:e.mieDirectionalG}),e.stars&&T.jsx(lt,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:1}),T.jsx("ambientLight",{intensity:e.ambientIntensity}),T.jsx("directionalLight",{position:e.sunPosition,intensity:e.stars?.2:1.5,castShadow:!0,"shadow-mapSize":[2048,2048],"shadow-camera-left":-50,"shadow-camera-right":50,"shadow-camera-top":50,"shadow-camera-bottom":-50})]})}export{pt as default};
